var version="9.8.0",active_contextmenu=!0,copy_count=0;function create_text_file(){$("#textfile_create_area").parent().parent().remove();var a=$("#lang_filename").val()+': <input type="text" id="create_text_file_name" style="min-height:30px"><br><hr><textarea id="textfile_create_area" style="width:100%;height:150px;"></textarea>';bootbox.dialog(a,[{label:$("#cancel").val(),class:"btn"},{label:$("#ok").val(),class:"btn-inverse",callback:function(){var a=$("#create_text_file_name").val(),e=$("#textfile_create_area").val();if(null!==a){a=fix_filename(a);var t=$("#sub_folder").val()+$("#fldr_value").val()+a,i=$("#cur_dir_thumb").val()+a;$.ajax({type:"POST",url:"execute.php?action=create_file",data:{path:t,path_thumb:i,name:a,new_content:e}}).done(function(a){""!=a&&bootbox.alert(a,function(a){setTimeout(function(){window.location.href=$("#refresh").attr("href")+"&"+(new Date).getTime()},500)})})}}}],{header:$("#lang_new_file").val()})}function edit_text_file(a){$("#textfile_edit_area").parent().parent().remove();var e=a.find(".rename-file").attr("data-thumb"),t=a.find(".rename-file").attr("data-path");$.ajax({type:"POST",url:"ajax_calls.php?action=get_file&sub_action=edit&preview_mode=text",data:{path:t}}).done(function(i){bootbox.dialog(i,[{label:$("#cancel").val(),class:"btn"},{label:$("#ok").val(),class:"btn-inverse",callback:function(){var a=$("#textfile_edit_area").val();$.ajax({type:"POST",url:"execute.php?action=save_text_file",data:{path:t,path_thumb:e,new_content:a}}).done(function(a){""!=a&&bootbox.alert(a)})}}],{header:a.find(".name_download").val()})})}function change_lang(){$.ajax({type:"POST",url:"ajax_calls.php?action=get_lang",data:{}}).done(function(a){bootbox.dialog(a,[{label:$("#cancel").val(),class:"btn"},{label:$("#ok").val(),class:"btn-inverse",callback:function(){var a=$("#new_lang_select option:selected").val();$.ajax({type:"POST",url:"ajax_calls.php?action=change_lang",data:{choosen_lang:a}}).done(function(a){""!=a?bootbox.alert(a):setTimeout(function(){window.location.href=$("#refresh").attr("href")+"&"+(new Date).getTime()},500)})}}],{header:$("#lang_lang_change").val()})})}function chmod(a){if($("#files_permission_start").parent().parent().remove(),a.hasClass("directory"))e=a.find(".rename-folder").attr("data-thumb"),t=a.find(".rename-folder").attr("data-path");else var e=a.find(".rename-file").attr("data-thumb"),t=a.find(".rename-file").attr("data-path");$.ajax({type:"POST",url:"ajax_calls.php?action=chmod",data:{path:t,path_thumb:e}}).done(function(a){bootbox.dialog(a,[{label:$("#cancel").val(),class:"btn"},{label:$("#ok").val(),class:"btn-inverse",callback:function(){var a=$("#chmod_form #chmod_value").val();if(""!=a&&void 0!==a){var i=$("#chmod_form input[name=apply_recursive]:checked").val();""!=i&&void 0!==i||(i="none"),$.ajax({type:"POST",url:"execute.php?action=chmod",data:{path:t,path_thumb:e,new_mode:a,is_recursive:i}}).done(function(a){""!=a&&bootbox.alert(a)})}}}],{header:$("#lang_file_permission").val()})})}function chmod_logic(a){var e=[];if(e.user=0,e.group=0,e.all=0,void 0!==a&&1==a){var t=$("#chmod_form #chmod_value").val();e.user=t.substr(0,1),e.group=t.substr(1,1),e.all=t.substr(2,1),$.each(e,function(a){(""==e[a]||0==$.isNumeric(e[a])||parseInt(e[a])<0||parseInt(e[a])>7)&&(e[a]="0")}),$("#chmod_form input:checkbox").each(function(){var a=$(this).attr("data-group"),t=$(this).attr("data-value");chmod_logic_helper(e[a],t)?$(this).prop("checked",!0):$(this).prop("checked",!1)})}else $("#chmod_form input:checkbox:checked").each(function(){var a=$(this).attr("data-group"),t=$(this).attr("data-value");e[a]=parseInt(e[a])+parseInt(t)}),$("#chmod_form #chmod_value").val(e.user.toString()+e.group.toString()+e.all.toString())}function chmod_logic_helper(a,e){var t=[];return t[1]=[1,3,5,7],t[2]=[2,3,6,7],t[4]=[4,5,6,7],a=parseInt(a),e=parseInt(e),-1!=$.inArray(a,t[e])}function clear_clipboard(){bootbox.confirm($("#lang_clear_clipboard_confirm").val(),$("#cancel").val(),$("#ok").val(),function(a){1==a&&$.ajax({type:"POST",url:"ajax_calls.php?action=clear_clipboard",data:{}}).done(function(a){""!=a?bootbox.alert(a):$("#clipboard").val("0"),toggle_clipboard(!1)})})}function copy_cut_clicked(a,e){if("copy"==e||"cut"==e){if(a.hasClass("directory"))t=a.find(".rename-folder").attr("data-thumb"),i=a.find(".rename-folder").attr("data-path");else var t=a.find(".rename-file").attr("data-thumb"),i=a.find(".rename-file").attr("data-path");$.ajax({type:"POST",url:"ajax_calls.php?action=copy_cut",data:{path:i,path_thumb:t,sub_action:e}}).done(function(a){""!=a?bootbox.alert(a):($("#clipboard").val("1"),toggle_clipboard(!0))})}}function paste_to_this_dir(a){bootbox.confirm($("#lang_paste_confirm").val(),$("#cancel").val(),$("#ok").val(),function(e){if(1==e){if(void 0!==a)var t=a.find(".rename-folder").attr("data-path"),i=a.find(".rename-folder").attr("data-thumb");else t=$("#sub_folder").val()+$("#fldr_value").val(),i=$("#cur_dir_thumb").val();$.ajax({type:"POST",url:"execute.php?action=paste_clipboard",data:{path:t,path_thumb:i}}).done(function(a){""!=a?bootbox.alert(a):($("#clipboard").val("0"),toggle_clipboard(!1),setTimeout(function(){window.location.href=$("#refresh").attr("href")+"&"+(new Date).getTime()},300))})}})}function drag_n_drop_paste(a,e){if(a.hasClass("directory"))t=a.find(".rename-folder").attr("data-thumb"),i=a.find(".rename-folder").attr("data-path");else var t=a.find(".rename-file").attr("data-thumb"),i=a.find(".rename-file").attr("data-path");$.ajax({type:"POST",url:"ajax_calls.php?action=copy_cut",data:{path:i,path_thumb:t,sub_action:"cut"}}).done(function(t){if(""!=t)bootbox.alert(t);else{if(void 0!==e)if(e.hasClass("back-directory"))var i=e.find(".path").val(),n=e.find(".path_thumb").val();else i=e.find(".rename-folder").attr("data-path"),n=e.find(".rename-folder").attr("data-thumb");else i=$("#sub_folder").val()+$("#fldr_value").val(),n=$("#cur_dir_thumb").val();$.ajax({type:"POST",url:"execute.php?action=paste_clipboard",data:{path:i,path_thumb:n}}).done(function(e){""!=e?bootbox.alert(e):($("#clipboard").val("0"),toggle_clipboard(!1),a.parent().remove())})}})}function toggle_clipboard(a){1==a?$(".paste-here-btn, .clear-clipboard-btn").removeClass("disabled"):$(".paste-here-btn, .clear-clipboard-btn").addClass("disabled")}function fix_colums(a){var e=$(".breadcrumb").width()+a;if($(".uploader").css("width",e),$("#view").val()>0){if(1==$("#view").val())$("ul.grid li, ul.grid figure").css("width","100%");else{var t=Math.floor(e/380);0==t&&(t=1,$("h4").css("font-size",12)),e=Math.floor(e/t-3),$("ul.grid li, ul.grid figure").css("width",e)}$("#help").hide()}else Modernizr.touch&&$("#help").show()}function swipe_reaction(a,e,t,i,n){var r=$(this);0==$("#view").val()&&(1==r.attr("toggle")?(r.attr("toggle",0),r.animate({top:"0px"},{queue:!1,duration:300})):(r.attr("toggle",1),r.animate({top:"-30px"},{queue:!1,duration:300})))}function encodeURL(a){for(var e=a.split("/"),t=3;t<e.length;t++)e[t]=encodeURIComponent(e[t]);return e.join("/")}function apply(a,e){if(1==$("#popup").val())var t=window.opener;else t=window.parent;var i=$("#cur_dir").val(),n=$("#subdir").val(),r=$("#base_url").val(),o=a.substr(0,a.lastIndexOf(".")),l=a.split(".").pop();l=l.toLowerCase();var c="",d=new Array("ogg","mp3","wav"),s=new Array("mp4","ogg","webm"),p=encodeURL((1==$("#return_relative_url").val()?n:r+i)+a);""!=e?1==$("#crossdomain").val()?t.postMessage({sender:"responsivefilemanager",url:p,field_id:e},"*"):($("#"+e,t.document).val(p).trigger("change"),"function"==typeof t.responsive_filemanager_callback&&t.responsive_filemanager_callback(e),close_window()):($.inArray(l,ext_img)>-1?c='<img src="'+p+'" alt="'+o+'" />':$.inArray(l,s)>-1?c='<video controls source src="'+p+'" type="video/'+l+'">'+o+"</video>":$.inArray(l,d)>-1?("mp3"==l&&(l="mpeg"),c='<audio controls src="'+p+'" type="audio/'+l+'">'+o+"</audio>"):c='<a href="'+p+'" title="'+o+'">'+o+"</a>",1==$("#crossdomain").val()?t.postMessage({sender:"responsivefilemanager",url:p,field_id:null,html:c},"*"):parent.tinymce.majorVersion<4?(parent.tinymce.activeEditor.execCommand("mceInsertContent",!1,c),parent.tinymce.activeEditor.windowManager.close(parent.tinymce.activeEditor.windowManager.params.mce_window_id)):(parent.tinymce.activeEditor.insertContent(c),parent.tinymce.activeEditor.windowManager.close()))}function apply_link(a,e){if(1==$("#popup").val())var t=window.opener;else t=window.parent;var i=$("#cur_dir").val();i=i.replace("\\","/");var n=$("#subdir").val();n=n.replace("\\","/");var r=$("#base_url").val(),o=encodeURL((1==$("#return_relative_url").val()?n:r+i)+a);""!=e?1==$("#crossdomain").val()?t.postMessage({sender:"responsivefilemanager",url:o,field_id:e},"*"):($("#"+e,t.document).val(o).trigger("change"),"function"==typeof t.responsive_filemanager_callback&&t.responsive_filemanager_callback(e),close_window()):apply_any(o)}function apply_img(a,e){if(1==$("#popup").val())var t=window.opener;else t=window.parent;var i=$("#cur_dir").val();i=i.replace("\\","/");var n=$("#subdir").val();n=n.replace("\\","/");var r=$("#base_url").val(),o=encodeURL((1==$("#return_relative_url").val()?n:r+i)+a);""!=e?1==$("#crossdomain").val()?t.postMessage({sender:"responsivefilemanager",url:o,field_id:e},"*"):($("#"+e,t.document).val(o).trigger("change"),"function"==typeof t.responsive_filemanager_callback&&t.responsive_filemanager_callback(e),close_window()):apply_any(o)}function apply_video(a,e){if(1==$("#popup").val())var t=window.opener;else t=window.parent;var i=$("#cur_dir").val();i=i.replace("\\","/");var n=$("#subdir").val();n=n.replace("\\","/");var r=$("#base_url").val(),o=encodeURL((1==$("#return_relative_url").val()?n:r+i)+a);""!=e?1==$("#crossdomain").val()?t.postMessage({sender:"responsivefilemanager",url:o,field_id:e},"*"):($("#"+e,t.document).val(o).trigger("change"),"function"==typeof t.responsive_filemanager_callback&&t.responsive_filemanager_callback(e),close_window()):apply_any(o)}function apply_none(a,e){if(""!=(t=$('li[data-name="'+a+'"]').find(".preview")).html()&&void 0!==t.html())$("#full-img").attr("src",decodeURIComponent(t.attr("data-url"))),0==t.hasClass("disabled")&&(show_animation(),$("#previewLightbox").lightbox());else if(""!=(t=$('li[data-name="'+a+'"]').find("a.file-preview-btn")).html()&&void 0!==t.html())$.ajax({url:t.attr("data-url"),success:function(a){bootbox.alert(a)}});else{var t=$('li[data-name="'+a+'"]').find(".modalAV");$("#previewAV").removeData("modal"),$("#previewAV").modal({backdrop:"static",keyboard:!1}),t.hasClass("audio")?$(".body-preview").css("height","80px"):$(".body-preview").css("height","345px"),$.ajax({url:decodeURIComponent(t.attr("data-url")),success:function(a){$(".body-preview").html(a)}})}}function apply_any(a){return 1==$("#crossdomain").val()?window.parent.postMessage({sender:"responsivefilemanager",url:a,field_id:null},"*"):parent.tinymce.majorVersion<4?(parent.tinymce.activeEditor.windowManager.params.setUrl(a),parent.tinymce.activeEditor.windowManager.close(parent.tinymce.activeEditor.windowManager.params.mce_window_id)):(parent.tinymce.activeEditor.windowManager.getParams().setUrl(a),parent.tinymce.activeEditor.windowManager.close()),!1}function close_window(){1==$("#popup").val()?window.close():void 0!==parent.jQuery&&parent.jQuery?parent.jQuery.fancybox.close():parent.$.fancybox.close()}function apply_file_duplicate(a,e){var t=a.parent().parent().parent().parent();t.after("<li class='"+t.attr("class")+"' data-name='"+t.attr("data-name")+"'>"+t.html()+"</li>");var i=t.next();apply_file_rename(i.find("figure"),e);var n=i.find(".download-form"),r="form"+(new Date).getTime();n.attr("id",r),n.find(".tip-right").attr("onclick","$('#"+r+"').submit();")}function apply_file_rename(a,e){a.attr("data-name",e),a.parent().attr("data-name",e),a.find("h4").find("a").text(e);var t=a.find("a.link"),i=(r=t.attr("data-file")).substring(r.lastIndexOf("/")+1),n=r.substring(r.lastIndexOf(".")+1);t.each(function(){$(this).attr("data-file",encodeURIComponent(e+"."+n))}),a.find("img").each(function(){var a=$(this).attr("src");$(this).attr("src",a.replace(i,e+"."+n)+"?time="+(new Date).getTime()),$(this).attr("alt",e+" thumbnails")});var r,o=a.find("a.preview");void 0!==(r=o.attr("data-url"))&&r&&o.attr("data-url",r.replace(encodeURIComponent(i),encodeURIComponent(e+"."+n))),a.parent().attr("data-name",e+"."+n),a.attr("data-name",e+"."+n),a.find(".name_download").val(e+"."+n);var l=a.find("a.rename-file"),c=a.find("a.delete-file"),d=l.attr("data-path"),s=l.attr("data-thumb"),p=d.replace(i,e+"."+n),u=s.replace(i,e+"."+n);l.attr("data-path",p),l.attr("data-thumb",u),c.attr("data-path",p),c.attr("data-thumb",u)}function apply_folder_rename(a,e){a.attr("data-name",e),a.find("figure").attr("data-name",e);var t=a.find("h4").find("a").text();a.find("h4 > a").text(e);var i=a.find(".folder-link"),n=i.attr("href"),r=$("#fldr_value").val(),o=n.replace("fldr="+r+encodeURIComponent(t),"fldr="+r+encodeURIComponent(e));i.each(function(){$(this).attr("href",o)});var l=a.find("a.delete-folder"),c=a.find("a.rename-folder"),d=c.attr("data-path"),s=c.attr("data-thumb"),p=d.lastIndexOf("/"),u=d.substr(0,p+1)+e;l.attr("data-path",u),c.attr("data-path",u);p=s.lastIndexOf("/"),u=s.substr(0,p+1)+e;l.attr("data-thumb",u),c.attr("data-thumb",u)}function replace_last(a,e,t){var i=new RegExp(e+"$");return a.replace(i,t)}function replaceDiacritics(a){for(var e=[/[\300-\306]/g,/[\340-\346]/g,/[\310-\313]/g,/[\350-\353]/g,/[\314-\317]/g,/[\354-\357]/g,/[\322-\330]/g,/[\362-\370]/g,/[\331-\334]/g,/[\371-\374]/g,/[\321]/g,/[\361]/g,/[\307]/g,/[\347]/g],t=["A","a","E","e","I","i","O","o","U","u","N","n","C","c"],i=0;i<e.length;i++)a=a.replace(e[i],t[i]);return a}function fix_filename(a){return null!=a?("true"==$("#transliteration").val()&&(a=(a=replaceDiacritics(a)).replace(/[^A-Za-z0-9\.\-\[\]\ \_]+/g,"")),"true"==$("#convert_spaces").val()&&(a=(a=a.replace(/ /g,$("#replace_with").val())).toLowerCase()),a=(a=(a=(a=(a=a.replace('"',"")).replace("'","")).replace("/","")).replace("\\","")).replace(/<\/?[^>]+(>|$)/g,""),$.trim(a)):null}function execute_action(a,e,t,i,n,r){null!==i&&(i=fix_filename(i),$.ajax({type:"POST",url:"execute.php?action="+a,data:{path:e,path_thumb:t,name:i.replace("/","")}}).done(function(a){return""!=a?(bootbox.alert(a),!1):(""!=r&&window[r](n,i),!0)}))}function sortUnorderedList(a,e,t){"string"==typeof a&&(a=$(a));var i=a.find("li.dir"),n=a.find("li.file"),r=[],o=[],l=[],c=[];$.each(i,function(a){var e=$(this),i=e.find(t).val();if($.isNumeric(i))for(i=parseFloat(i);void 0!==r[i]&&r[i];)i=parseFloat(parseFloat(i)+parseFloat(.001));else i=i+"a"+e.find("h4 a").attr("data-file");r[i]=e.html(),o.push(i)}),$.each(n,function(a){var e=$(this),i=e.find(t).val();if($.isNumeric(i))for(i=parseFloat(i);void 0!==l[i]&&l[i];)i=parseFloat(parseFloat(i)+parseFloat(.001));else i=i+"a"+e.find("h4 a").attr("data-file");l[i]=e.html(),c.push(i)}),$.isNumeric(o[0])?o.sort(function(a,e){return parseFloat(a)-parseFloat(e)}):o.sort(),$.isNumeric(c[0])?c.sort(function(a,e){return parseFloat(a)-parseFloat(e)}):c.sort(),e&&(o.reverse(),c.reverse()),$.each(i,function(a){$(this).html(r[o[a]])}),$.each(n,function(a){$(this).html(l[c[a]])})}function show_animation(){$("#loading_container").css("display","block"),$("#loading").css("opacity",".7")}function hide_animation(){$("#loading_container").fadeOut()}function launchEditor(a,e){return featherEditor.launch({image:a,url:e}),!1}function lazyLoad(){$(window).trigger("scroll")}$(document).ready(function(){active_contextmenu&&($.contextMenu({selector:"figure:not(.back-directory), .list-view2 figure:not(.back-directory)",autoHide:!0,build:function(a){a.addClass("selected");var e={callback:function(e,t){switch(e){case"copy_url":var i=$("#base_url").val()+$("#cur_dir").val();add=a.find("a.link").attr("data-file"),""!=add&&null!=add&&(i+=add),add=a.find("h4 a.folder-link").attr("data-file"),""!=add&&null!=add&&(i+=add),bootbox.alert('URL:<br/><div class="input-append" style="width:100%"><input id="url_text'+copy_count+'" type="text" style="width:80%; height:30px;" value="'+encodeURL(i)+'" /><button id="copy-button'+copy_count+'" class="btn btn-inverse copy-button" style="width:20%; height:30px;" data-clipboard-target="url_text'+copy_count+'" data-clipboard-text="Copy Me!" title="copy"></button></div>'),$("#copy-button"+copy_count).html('<i class="icon icon-white icon-share"></i> '+$("#lang_copy").val());var n=new ZeroClipboard($("#copy-button"+copy_count));n.on("ready",function(a){n.on("wrongFlash noFlash",function(){ZeroClipboard.destroy()}),n.on("aftercopy",function(a){$("#copy-button"+copy_count).html('<i class="icon icon-ok"></i> '+$("#ok").val()),$("#copy-button"+copy_count).attr("class","btn disabled"),copy_count++}),n.on("error",function(a){console.log('ZeroClipboard error of type "'+a.name+'": '+a.message)})});break;case"unzip":i=$("#sub_folder").val()+$("#fldr_value").val()+a.find("a.link").attr("data-file");$.ajax({type:"POST",url:"ajax_calls.php?action=extract",data:{path:i}}).done(function(a){""!=a?bootbox.alert(a):window.location.href=$("#refresh").attr("href")+"&"+(new Date).getTime()});break;case"edit_img":var r=a.attr("data-name"),o=$("#base_url_true").val()+$("#cur_dir").val()+r;$("#aviary_img").attr("data-name",r),$("#aviary_img").attr("src",o).load(launchEditor("aviary_img",o));break;case"duplicate":var l=a.find("h4").text().trim();bootbox.prompt($("#lang_duplicate").val(),$("#cancel").val(),$("#ok").val(),function(e){if(null!==e&&(e=fix_filename(e))!=l){var t=a.find(".rename-file");execute_action("duplicate_file",t.attr("data-path"),t.attr("data-thumb"),e,t,"apply_file_duplicate")}},l);break;case"copy":copy_cut_clicked(a,"copy");break;case"cut":copy_cut_clicked(a,"cut");break;case"paste":paste_to_this_dir();break;case"chmod":chmod(a);break;case"edit_text_file":edit_text_file(a)}},items:{}};return(a.find(".img-precontainer-mini .filetype").hasClass("png")||a.find(".img-precontainer-mini .filetype").hasClass("jpg")||a.find(".img-precontainer-mini .filetype").hasClass("jpeg"))&&image_editor&&(e.items.edit_img={name:$("#lang_edit_image").val(),icon:"edit_img",disabled:!1}),e.items.copy_url={name:$("#lang_show_url").val(),icon:"url",disabled:!1},(a.find(".img-precontainer-mini .filetype").hasClass("zip")||a.find(".img-precontainer-mini .filetype").hasClass("tar")||a.find(".img-precontainer-mini .filetype").hasClass("gz"))&&(e.items.unzip={name:$("#lang_extract").val(),icon:"extract",disabled:!1}),a.find(".img-precontainer-mini .filetype").hasClass("edit-text-file-allowed")&&(e.items.edit_text_file={name:$("#lang_edit_file").val(),icon:"edit",disabled:!1}),a.hasClass("directory")||1!=$("#duplicate").val()||(e.items.duplicate={name:$("#lang_duplicate").val(),icon:"duplicate",disabled:!1}),a.hasClass("directory")||1!=$("#copy_cut_files_allowed").val()?a.hasClass("directory")&&1==$("#copy_cut_dirs_allowed").val()&&(e.items.copy={name:$("#lang_copy").val(),icon:"copy",disabled:!1},e.items.cut={name:$("#lang_cut").val(),icon:"cut",disabled:!1}):(e.items.copy={name:$("#lang_copy").val(),icon:"copy",disabled:!1},e.items.cut={name:$("#lang_cut").val(),icon:"cut",disabled:!1}),0==$("#clipboard").val()||a.hasClass("directory")||(e.items.paste={name:$("#lang_paste_here").val(),icon:"clipboard-apply",disabled:!1}),a.hasClass("directory")||1!=$("#chmod_files_allowed").val()?a.hasClass("directory")&&1==$("#chmod_dirs_allowed").val()&&(e.items.chmod={name:$("#lang_file_permission").val(),icon:"key",disabled:!1}):e.items.chmod={name:$("#lang_file_permission").val(),icon:"key",disabled:!1},e.items.sep="----",e.items.info={name:"<strong>"+$("#lang_file_info").val()+"</strong>",disabled:!0},e.items.name={name:a.attr("data-name"),icon:"label",disabled:!0},"img"==a.attr("data-type")&&(e.items.dimension={name:a.find(".img-dimension").html(),icon:"dimension",disabled:!0}),e.items.size={name:a.find(".file-size").html(),icon:"size",disabled:!0},e.items.date={name:a.find(".file-date").html(),icon:"date",disabled:!0},e},events:{hide:function(a){$("figure").removeClass("selected")}}}),$(document).on("contextmenu",function(a){if(!$(a.target).is("figure"))return!1})),$("#full-img").on("click",function(){$("#previewLightbox").lightbox("hide")}),$("ul.grid").on("click",".modalAV",function(a){_this=$(this),a.preventDefault(),$("#previewAV").removeData("modal"),$("#previewAV").modal({backdrop:"static",keyboard:!1}),_this.hasClass("audio")?$(".body-preview").css("height","80px"):$(".body-preview").css("height","345px"),$.ajax({url:_this.attr("data-url"),success:function(a){$(".body-preview").html(a)}})}),$("ul.grid").on("click",".file-preview-btn",function(a){_this=$(this),a.preventDefault(),$.ajax({url:_this.attr("data-url"),success:function(a){bootbox.alert(a)}})}),$("input[name=radio-sort]").on("click",function(){var a=$(this).attr("data-item");$(".filters label").removeClass("btn-inverse"),$(".filters label").find("i").removeClass("icon-white"),$("#filter-input").val(""),$("#"+a).addClass("btn-inverse"),$("#"+a).find("i").addClass("icon-white"),"ff-item-type-all"==a?$(".grid li").show(300):$(this).is(":checked")&&($(".grid li").not("."+a).hide(300),$(".grid li."+a).show(300)),lazyLoad()});var a,e=(a=0,function(e,t){clearTimeout(a),a=setTimeout(e,t)});if(parseInt($("#file_number").val())>parseInt($("#file_number_limit_js").val()))var t=!1;else t=!0;$("#filter-input").on("keyup",function(){$(".filters label").removeClass("btn-inverse"),$(".filters label").find("i").removeClass("icon-white"),$("#ff-item-type-all").addClass("btn-inverse"),$("#ff-item-type-all").find("i").addClass("icon-white");var a=fix_filename($(this).val());$(this).val(a),e(function(){t&&($("ul.grid li").each(function(){var e=$(this);""!=a&&-1==e.attr("data-name").toString().toLowerCase().indexOf(a.toLowerCase())?e.hide(100):e.show(100)}),lazyLoad(),$.ajax({url:"ajax_calls.php?action=filter&type="+a}).done(function(a){""!=a&&bootbox.alert(a)}))},300)}).keypress(function(a){13==a.which&&$("#filter").trigger("click")}),$("#filter").on("click",function(){var a=fix_filename($("#filter-input").val());window.location.href=$("#current_url").val()+"&filter="+a}),$("#info").on("click",function(){bootbox.alert('<div class="text-center"><br/><img src="img/logo.png" alt="responsive filemanager"/><br/><br/><p><strong>RESPONSIVE filemanager v.'+version+'</strong><br/><a href="http://www.responsivefilemanager.com">responsivefilemanager.com</a></p><br/><p>Copyright © <a href="http://www.tecrail.com" alt="tecrail">Tecrail</a> - Alberto Peripolli. All rights reserved.</p><br/><p>License<br/><small><img alt="Creative Commons License" style="border-width:0" src="http://responsivefilemanager.com/license.php" /><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc/3.0/">Creative Commons Attribution-NonCommercial 3.0 Unported License</a>.</small></p></div>')}),$("#change_lang_btn").on("click",function(){change_lang()}),$("#uploader-btn").on("click",function(){var a=$("#sub_folder").val()+$("#fldr_value").val()+"/";a=a.substring(0,a.length-1),$("#iframe-container").html($("<iframe />",{name:"JUpload",id:"uploader_frame",src:"uploader/index.php?path="+a,frameborder:0,width:"100%",height:360}))}),$(".upload-btn").on("click",function(){$(".uploader").show(500)});var i=$("#descending").val();function n(a){window[a.attr("data-function")](a.attr("data-file"),a.attr("data-field_id"))}$(".sorter").on("click",function(){_this=$(this),i=$("#sort_by").val()!==_this.attr("data-sort")||0==i,t?($.ajax({url:"ajax_calls.php?action=sort&sort_by="+_this.attr("data-sort")+"&descending="+(i?1:0)}),sortUnorderedList("ul.grid",i,"."+_this.attr("data-sort")),$(" a.sorter").removeClass("descending").removeClass("ascending"),i?$(".sort-"+_this.attr("data-sort")).addClass("descending"):$(".sort-"+_this.attr("data-sort")).addClass("ascending"),$("#sort_by").val(_this.attr("data-sort")),$("#descending").val(i?1:0),lazyLoad()):window.location.href=$("#current_url").val()+"&sort_by="+_this.attr("data-sort")+"&descending="+(i?1:0)}),$(".close-uploader").on("click",function(){$(".uploader").hide(500),setTimeout(function(){window.location.href=$("#refresh").attr("href")+"&"+(new Date).getTime()},420)}),$("ul.grid").on("click",".preview",function(){var a=$(this);return $("#full-img").attr("src",decodeURIComponent(a.attr("data-url"))),0==a.hasClass("disabled")&&show_animation(),!0}),$("body").on("keypress",function(a){var e=String.fromCharCode(a.which);if("'"==e||'"'==e||"\\"==e||"/"==e)return!1}),$("ul.grid").on("click",".rename-file",function(){var a=$(this),e=a.parent().parent().parent(),t=e.find("h4"),i=$.trim(t.text());bootbox.prompt($("#rename").val(),$("#cancel").val(),$("#ok").val(),function(t){null!==t&&(t=fix_filename(t))!=i&&execute_action("rename_file",a.attr("data-path"),a.attr("data-thumb"),t,e,"apply_file_rename")},i)}),$("ul.grid").on("click",".rename-folder",function(){var a=$(this),e=a.parent().parent().parent(),t=e.find("h4"),i=$.trim(t.text());bootbox.prompt($("#rename").val(),$("#cancel").val(),$("#ok").val(),function(t){null!==t&&(t=fix_filename(t).replace(".",""))!=i&&execute_action("rename_folder",a.attr("data-path"),a.attr("data-thumb"),t,e,"apply_folder_rename")},i)}),$("ul.grid").on("click",".delete-file",function(){var a=$(this);bootbox.confirm(a.attr("data-confirm"),$("#cancel").val(),$("#ok").val(),function(e){1==e&&(execute_action("delete_file",a.attr("data-path"),a.attr("data-thumb"),"","",""),a.parent().parent().parent().parent().remove())})}),$("ul.grid").on("click",".delete-folder",function(){var a=$(this);bootbox.confirm(a.attr("data-confirm"),$("#cancel").val(),$("#ok").val(),function(e){1==e&&(execute_action("delete_folder",a.attr("data-path"),a.attr("data-thumb"),"","",""),a.parent().parent().parent().remove())})}),$(".create-file-btn").on("click",function(){create_text_file()}),$(".new-folder").on("click",function(){bootbox.prompt($("#insert_folder_name").val(),$("#cancel").val(),$("#ok").val(),function(a){if(null!==a){a=fix_filename(a).replace(".","");var e=$("#sub_folder").val()+$("#fldr_value").val()+a,t=$("#cur_dir_thumb").val()+a;$.ajax({type:"POST",url:"execute.php?action=create_folder",data:{path:e,path_thumb:t}}).done(function(a){setTimeout(function(){window.location.href=$("#refresh").attr("href")+"&"+(new Date).getTime()},300)})}},$("#new_folder").val())}),$(".view-controller button").on("click",function(){var a=$(this);$(".view-controller button").removeClass("btn-inverse"),$(".view-controller i").removeClass("icon-white"),a.addClass("btn-inverse"),a.find("i").addClass("icon-white"),$.ajax({url:"ajax_calls.php?action=view&type="+a.attr("data-value")}).done(function(a){""!=a&&bootbox.alert(a)}),void 0!==$("ul.grid")[0]&&$("ul.grid")[0]&&($("ul.grid")[0].className=$("ul.grid")[0].className.replace(/\blist-view.*?\b/g,"")),void 0!==$(".sorter-container")[0]&&$(".sorter-container")[0]&&($(".sorter-container")[0].className=$(".sorter-container")[0].className.replace(/\blist-view.*?\b/g,""));var e=a.attr("data-value");$("#view").val(e),$("ul.grid").addClass("list-view"+e),$(".sorter-container").addClass("list-view"+e),a.attr("data-value")>=1?fix_colums(14):($("ul.grid li").css("width",126),$("ul.grid figure").css("width",122)),lazyLoad()}),Modernizr.touch?($("#help").show(),$(".box:not(.no-effect)").swipe({swipeLeft:swipe_reaction,swipeRight:swipe_reaction,threshold:30})):($(".tip").tooltip({placement:"bottom"}),$(".tip-top").tooltip({placement:"top"}),$(".tip-left").tooltip({placement:"left"}),$(".tip-right").tooltip({placement:"right"}),$("body").addClass("no-touch")),$(".paste-here-btn").on("click",function(){0==$(this).hasClass("disabled")&&paste_to_this_dir()}),$(".clear-clipboard-btn").on("click",function(){0==$(this).hasClass("disabled")&&clear_clipboard()}),Modernizr.csstransforms||($("figure").on("mouseover",function(){0==$("#view").val()&&!1===$("#main-item-container").hasClass("no-effect-slide")&&$(this).find(".box:not(.no-effect)").animate({top:"-26px"},{queue:!1,duration:300})}),$("figure").on("mouseout",function(){0==$("#view").val()&&$(this).find(".box:not(.no-effect)").animate({top:"0px"},{queue:!1,duration:300})})),$(window).resize(function(){fix_colums(28)}),fix_colums(14),$("ul.grid .link").on("click",function(){n($(this))}),$("ul.grid div.box").on("click",function(a){var e=$(this).find(".link");if(0!==e.length)n(e);else{var t=$(this).find(".folder-link");0!==t.length&&(document.location=$(t).prop("href"))}}),1==$("#clipboard").val()?toggle_clipboard(!0):toggle_clipboard(!1),$(document).on("keyup","#chmod_form #chmod_value",function(){chmod_logic(!0)}),$(document).on("focusout","#chmod_form #chmod_value",function(){if(null==$("#chmod_form #chmod_value").val().match(/^[0-7]{3}$/)){var a=$("#chmod_form #chmod_value").attr("data-def-value");$("#chmod_form #chmod_value").val(a),chmod_logic(!0)}})});